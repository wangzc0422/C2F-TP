# C2F-TP: A Coarse-to-fine Denoising Framework for Surrounding-aware Trajectory Prediction
This repository contains the official implementation of C2F-TP: A Coarse-to-fine Denoising Framework for Surrounding-aware Trajectory Prediction.
## Background
Accurate trajectory prediction, integrating interaction modeling across surrounding vehicles, is critically essential to enable driving safety, predictability, and reliability in dense scenarios for autonomous driving. However, many recent proposals that target deep learning for trajectory prediction fail to model the inherent stochastic nature of trajectories. Such proposals may generate unrealistic trajectory prediction results, thus deteriorating prediction performance when applied in real-world applications. To enable realistic trajectory prediction, we propose a coarse-to-fine denoising framework C2F-TP for surrounding-aware vehicle trajectory prediction, where we consider vehicles as waves and model vehicle interactions dynamically with wave superpositions. C2F-TP features an innovative two-stage generation process. The first dual-view sample stage aims to learn implicit distributions of future trajectories, where a novel re-weighted multi-modal trajectory predictor is proposed to model comprehensive driving behaviors. We then sample a certain number of coarse trajectories from the learned distributions. The sampled trajectories are then fed into the refinement stage based on a conditional denoising model to generate realistic future trajectories by incorporating uncertainties. Extensive experiments on real data offer insight into the effectiveness of the proposed framework. 
## Model
picture
## Datasets
### NGSIM
The NGSIM dataset contains trajectories of real freeway traffic captured at 10 Hz over a time span of 45 minutes in 2015. It is collected on eastbound I-80 in the San Francisco Bay area and southbound US 101 in Los Angeles. Like the baselines, the NGSIM dataset in our work is segmented in the same way as in the most widely used work [Deo and Trivedi, 2018](https://github.com/nachiket92/conv-social-pooling), so that comparisons can be made. We will provide matlab code for NGSIM data processing.
### highD
The highD dataset consists of trajectories of 110000 vehicles recorded at 25 Hz, which are collected at a segment of two-way roads around Cologne in Germany from 2017 to 2018. Due to the policy requirements of this dataset, please request and download the HighD dataset from the [highD official website](https://www.highd-dataset.com/). Normally, applications take 7-14 working days to be approved.
